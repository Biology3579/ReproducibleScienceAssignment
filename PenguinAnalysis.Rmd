---
title: "PenguinsAnalysis"
author: "Biology3579"
date: "2024-12-6"
output:
  pdf_document: 
    latex_engine: xelatex
  html_document: default
geometry: left = 0.5cm, right = 1cm, top = 1cm, bottom = 1cm
mainfont: Arial
---

```{r set-up, include = FALSE}
knitr::opts_chunk$set(
  echo = TRUE,       # Show R code in the document
  warning = FALSE,   # Suppress warnings
  message = FALSE   # Suppress messages
)
```

### Introduction

The genus Pygoscelis, which includes Adélie (*Pygoscelis adeliae*), Chinstrap (*Pygoscelis antarcticus*), and Gentoo (*Pygoscelis papua*) penguins, occupies overlapping ranges across the Western Antarctic Peninsula. Despite this sympatric distribution, these species exhibit distinct feeding ecologies, ranging from specialist to generalist strategies, allowing them to occupy different ecological niches and minimising competition. Diet composition analysis of Chinstrap penguins shows a high degree of specialization, with their diet consisting almost exclusively of the krill species *Euphausia superba*. In contrast, while Adélie penguins also rely heavily on krill, their diet is more varied, consisting of both *E. superba* and *E. crystallorophias* krill species, along with notothenioid fish. Dietary analyses of Gentoo penguins reveal that this species has the most varied feeding habits, with a generalist diet consisting of a broad range of crustaceans and fish. Interestingly, krill constitutes a smaller portion of their diet compared to other *Pygoscelis* species, highlighting a distinct difference in the feeding ecology of this species.

The bill morphology of penguins is a critical aspect of their feeding ecology, as it directly influences their ability to capture and consume different prey types. A study by Chávez-Hoffmeister (2020) found that penguin species display distinct bill shapes that are closely tied to their specific feeding strategies []. For example, krill-eating penguins tend to have wider beaks and broader jaws, which help them efficiently filter and capture krill. In contrast, fish-eating species possess narrower, more robust beaks designed to exert greater bite force, allowing them to grasp and hold onto slippery fish more effectively. These morphological adaptations are essential for the species' feeding behavior, enabling them to exploit their preferred prey types. As such, each penguin species requires bill morphology that is finely tuned to its ecological niche, ensuring efficient foraging and survival in their specific environments.

### Hypothesis

Based on the importance of bill morphology in feeding behaviors and the differences in feeding ecologies between the species, I hypothesize that the three penguin species will exhibit distinct bill morphologies that reflect their specific feeding strategies. Specifically, since Gentoo penguins have a much more diverse diet compared to the other two species, I expect them to exhibit the most distinct bill morphology.

### Methods

#### Data

To investigate the differences in bill morphology across penguin species, I will be utilizing the palmerpenguins dataset, which is derived from a study conducted by Gorman et al. (2014) on Pygoscelis penguins in the Palmer Archipelago, located west of the Antarctic Peninsula, near Anvers Island. The data were collected from 2007 to 2009 across three islands: Biscoe (64° 48.9'S, 63° 46.9'W), Torgersen (64° 46.9'S, 64° 04.9'W), and Dream (64° 43.9'S, 64° 13.9'W). This dataset includes multiple measurements taken on three species of Pygoscelis penguins—Adélie, Chinstrap, and Gentoo—observed on these three islands, including body measurements (culmen length, culmen depth, flipper length, and body mass), sex information, nesting details (including clutch completion and egg laying dates), and stable isotope data (Δ15N and Δ13C) for 344 individual penguins across three species.

#### Statistical analysis

To examine the differences in bill morphology across the three penguin speciesI will focus on two key measurements: bill length and bill depth. These measurements serve as indicators of bill morphology, providing insights into how adaptations to feeding strategies differ among species with varying diets.

1.  Ratio of Bill Length to Bill Depth The first step in my analysis will involve examining the ratio of bill length to bill depth for each species. This ratio is a useful indicator of overall bill shape and can help highlight differences in bill morphology that are associated with each species' feeding ecology. For example, a more specialized feeder may have a differently proportioned bill compared to a more generalist species.

ANOVA tests assess whether there are any statistically significant differences in bill morphology, bill length, or bill depth between the species. The Tukey-Kramer test provides pairwise comparisons to identify which species pairs differ significantly from each other.

Statistical Test: One-Way ANOVA I will use one-way ANOVA to compare the mean ratio of bill length to bill depth across the three species (Adélie, Chinstrap, and Gentoo). ANOVA is appropriate for this analysis because I am comparing the means of a continuous variable (bill ratio) across more than two groups (species).

Rationale for ANOVA: ANOVA is ideal for testing if there are significant differences in the means of the bill ratio across the three species. If the ANOVA reveals a significant result, this would indicate that at least one species has a significantly different bill morphology in terms of its shape (ratio of length to depth).

Post-Hoc Analysis: If the ANOVA test shows significant differences, I will conduct post-hoc tests, such as Tukey’s HSD (Honest Significant Difference), to determine which specific species pairs (e.g., Adélie vs. Gentoo) show significant differences in bill morphology. This is necessary to identify exactly where the differences lie between species.

2.  Bill Length and Bill Depth Comparisons Following the ratio analysis, I will delve deeper into the individual measurements of bill length and bill depth. This will allow for a more detailed comparison of these specific morphological features across the species.

Statistical Test: One-Way ANOVA (for normally distributed data) I will first assess the normality of bill length and bill depth data for each species using tests such as the Shapiro-Wilk test. If the data are normally distributed, I will use one-way ANOVA to compare the means of bill length and bill depth across the three species.

Rationale for ANOVA: ANOVA is again used here to determine if there are significant differences in the bill length and bill depth among the species. A significant result would indicate that the species exhibit different morphologies in these specific aspects, which could be linked to their feeding behavior and ecological niches. I used this dataset to examine the culmen shapes of the different species, specifically, I will be focusing on two measurements - bill length and bill depth - as indicators of bill morphology.

To provide more precise estimates of the species’ bill characteristics, I also calculated 95% confidence intervals for both bill length and bill depth. Confidence intervals are important because they offer a range within which the true population mean is likely to lie, allowing for a better understanding of the variability and uncertainty around the estimates. By including these intervals, I am able to give a more robust and complete picture of the data, helping to interpret the significance of the differences observed in the ANOVA and Tukey-Kramer tests.

## Analysis

```{r packages}

#load all the required packages
library(tidyverse) #for cleaning the data
library(janitor) #for cleaning the data
library(palmerpenguins) #contains the dataset
library(here) #to specify the directory
library(ggplot2) #for making plots
library(lme4) #for making linear models
library(grid) #for making multi-panel figures
library(gridExtra) #for making multi-panel figures
library(dplyr) #for manipulating the data
library(ggsignif) #for adding significance stars to plots
```

```{r load-&-save-data}
#Load the raw data and save it
write.csv(penguins_raw, here("data", "penguins_raw.csv")) #To write data to csv
penguins_raw <- read.csv(here("data","penguins_raw.csv")) #Load data 
glimpse(penguins_raw) # Quick summary of the structure of the raw data
```

```{r clean-&-save-data}
#Clean the raw data and save it separately
source(here("functions", "cleaning_and_curating.R"))
penguins_clean <- cleaning_penguins(penguins_raw)
write_csv(penguins_clean, here("data", "penguins_clean.csv"))
glimpse(penguins_clean) # Quick summary of clean data
```

```{r curate-&-save-data}
#Curate the clean data and save it separately
source(here("functions", "cleaning_and_curating.R"))
analysis_data <- curating_penguins_clean(penguins_clean)
write_csv(analysis_data, here("data", "analysis_data.csv"))
glimpse(analysis_data) # Quick summary of analysis data
```

### Exploratory analysis

```{r bad-figure-plot, fig.align = "center", echo=FALSE}
source(here("functions", "plotting.R"))
bad_figure <- plot_bad_figure(analysis_data)
print(bad_figure)

#Save plot 
#gsave("exploratory_figure.png", 
       #plot = exploratory_figure, 
       #width = 8, height = 6, units = "in", dpi = 300) 
```
*Figure 1: A bar chart of mean bill length vs. mean bill depth for three species of Pygoscelis* penguins

b)  Write about how your design choices mislead the reader about the underlying data (200-300 words).

This figure displays the mean bill length and depth for Adelie, Chinstrap, and Gentoo penguins. However, several design choices in this figure mislead the reader about the underlying data:

-   A bar chart is a poor choice for displaying relationships between two continuous variables. Bar charts are typically used for categorical data, and applying them to continuous data (such as bill length and depth) oversimplifies the relationship. A scatter plot would be much more suited for representing .. []

-   The figure only shows the summary statistics (mean values) for each species but does not include any raw data points or an indication of the data distribution. Without this, the reader cannot assess variability, outliers, or trends within each species, which are critical for understanding the data. This omission hides the true complexity and spread of the data. []

-   The plot also lacks error bars or any indication of variability, such as standard deviation or confidence intervals. These are essential for understanding the precision of the mean values and the reliability of the comparisons between species. Without this information, the plot may give the false impression that the differences between species are more significant than they actually are []

-   The colors used for the three species are all very similar and difficult to distinguish at a glance. This makes it hard for the viewer to quickly differentiate between species, even with a legend, and could cause confusion. More contrasting colors or patterns should have been used to make the distinction clearer.

-   The axis labels are not informative and do not covey the units. Clearer labels would indicate what is being measured and ...

**Good exploratory figure**

```{r  exploratory-figure-plot, fig.align = "center"}

source(here("functions", "plotting.R"))
exploratory_figure <- plot_exploratory_figure(analysis_data)
exploratory_figure # Show the plot

#Save plot 
#gsave("exploratory_figure.png", 
       #plot = exploratory_figure, 
       #width = 8, height = 6, units = "in", dpi = 300)  
```

*Figure 2: Scatterplot showing the distribution of bill lengths and bill depths for three species of Pygoscelis* penguins

Figure 2.A, we observe that the distribution of bill length and bill depth varies between the three penguin species. Adelie penguins tend to have smaller bill lengths and depths compared to the other species, while Chinstrap penguins show intermediate values. Gentoo penguins, on the other hand, display larger bills, with both the length and depth showing more variability across individuals...

The dsitrbution ,,,

Howver to fully deterine whetehr these differeces are we ...

### Statistical analysis

I first carried out an ANOVA, followed by Tukey-Kramer tests, to determine the general differences in bill morphology, using the bill length-to-depth ratio as a proxy for this. I then further investigated specific differences by testing bill length and bill depth separately to understand the variation between species. To provide more precise estimates of the species’ bill characteristics, I also calculated 95% confidence intervals for both bill length and bill depth.

#### Differences in bill morphology

```{r bill-morphology-ANOVA}
# ANOVA to test for differences in bill morphology between penguin species
bill_morphology_model <- lm(bill_morphology ~ species, data = analysis_data)
anova(bill_morphology_model)
```

```{r bill-morphology-Tukey-Kramer}
# Tukey-Kramer test for pairwise comparisons of bill morphology between penguin species
TukeyHSD(aov(bill_morphology_model))
```

#### Differences in bill length

```{r bill-length-ANOVA}
# ANOVA to test for differences in bill length between penguin species
bill_length_model <- lm(bill_length_mm ~ species, data = analysis_data)
anova(bill_length_model)
```

```{r bill-length-Tukey-Kramer}
# Tukey-Kramer test for pairwise comparisons of bill length between penguin species
TukeyHSD(aov(bill_length_model))
```

```{r bill-length-CIs}
# Pipe to calculate 95% confidence intervals for bill length
CIs_bill_length <- analysis_data %>%
  group_by(species) %>%
  summarise(
    mean_length = mean(bill_length_mm, na.rm = TRUE),
    se_length = sd(bill_length_mm, na.rm = TRUE) / sqrt(n()),
    lower_length_ci = mean_length - 1.96 * se_length,
    upper_length_ci = mean_length + 1.96 * se_length
  )

print(CIs_bill_length)
```

#### Differences in bill depth

```{r bill-depth-ANOVA}
# ANOVA to test for differences in bill depth between penguin species
bill_depth_model <- lm(bill_depth_mm ~ species, data = analysis_data)
anova(bill_depth_model)
```

```{r bill-depth-Tukey-Kramer}
# Tukey-Kramer test for pairwise comparisons of bill depth between penguin species
TukeyHSD(aov(bill_depth_model))
```

```{r bill-depth-CIs}
# Pipe to calculate confidence intervals for bill depth
CIs_bill_depth <- analysis_data %>%
  group_by(species) %>%
  summarise(
    mean_depth = mean(bill_depth_mm, na.rm = TRUE),
    se_depth = sd(bill_depth_mm, na.rm = TRUE) / sqrt(n()),
    lower_depth_ci = mean_depth - 1.96 * se_depth,
    upper_depth_ci = mean_depth + 1.96 * se_depth
  )

print(CIs_bill_depth)
```

##Results

```{r result-figure-plots}
source(here("functions", "plotting.R"))
results_figure_1 <- results_plot_1(analysis_data)

#Save plot 
#gsave("exploratory_figure.png", 
       #plot = exploratory_figure, 
       #width = 8, height = 6, units = "in", dpi = 300)
       
results_figure_2 <- results_plot_2(analysis_data)

#Save plot 
#gsave("exploratory_figure.png", 
       #plot = exploratory_figure, 
       #width = 8, height = 6, units = "in", dpi = 300)

#Make a multi-panel figure
grid.arrange(results_figure_1,  results_figure_2,  nrow = 2)

grid.text("A", x = 0.07, y = 0.95, gp = gpar(fontsize = 12)) #Adds label 'A' to first graph
grid.text("B", x = 0.57, y = 0.95, gp = gpar(fontsize = 12)) #Adds label 'B' to second graph

```
*Figure 3. A plot ... *

### Conclusion

Beak Shape Ratio: The ratio of culmen length to depth significantly differs across species. Gentoo penguins have the largest ratio, followed by Chinstrap penguins, and Adelie penguins have the smallest ratio.

Interpretation of Shape: Since the ratio is a measure of beak shape, this suggests that Gentoo penguins have relatively longer, shallower beaks, while Adelie penguins have shorter, deeper beaks.

Beak Length: Chinstrap and Gentoo penguins both have significantly longer beaks than Adelie penguins. Gentoo penguins have slightly shorter beaks than Chinstrap penguins, though this difference is still statistically significant. Beak Depth: Gentoo penguins have significantly deeper beaks compared to both Adelie and Chinstrap penguins. There is no significant difference in beak depth between Chinstrap and Adelie penguins. Are the results informative? Yes, these results are informative because:

They show clear patterns of differences in beak morphology (both length and depth) across species. The TukeyHSD results reveal specific comparisons, quantifying the size and direction of differences between species.

These findings align well with feeding habits.

As the cliamte changes, wih rapidly decling extent and duration of sea ice in Antartica, with correlated reductions in Antarctic krill6 (Euphausia superba), the main prey item for most meso- and top-predators in the Antarctic ecosystem will decrease. A recent article suggetsed that gentoo, which have the most diverse diets, will be able to adpat whilst chinsatrp and adelie, have been showing recent declines in. As such, nless these penguisna re able to adapt, they will perish (Clucas et al., 2014). Signficantylm I argue that bill mropholgoy mught be amn impritnat determinant of diet, as it will speciesl;ay how they hunt and how ffectively they ctahc prey. of course mophological liamitaions and gentics will limit how quicly these can adapt and diactet whetehr tbe penguisna re able to survive at all.

### References

...

------------------------------------------------------------------------

##  Open Science

**a) My GitHub link**

<https://github.com/Biology3579/ReproducibleScienceAssignment.git>


**b) Partner's GitHub link:**
<https://github.com/Anonymous94394/PalmerPenguins.git>


### c) Reflect on your experience running their code. (300-500 words)

-   *What elements of your partner's code helped you to understand their data pipeline?*

-   *Did it run? Did you need to fix anything?*

-   *What suggestions would you make for improving their code to make it more understandable or reproducible, and why?*

-   *If you needed to alter your partner's figure using their code, do you think that would be easy or difficult, and why?*

### d) Reflect on your own code based on your experience with your partner's code and their review of yours. (300-500 words)

-   *What improvements did they suggest, and do you agree?*

-   *What did you learn about writing code for other people?*
